const translations = {
    en: {
        nav_goddess: "Goddess Test",
        nav_nakamoto: "Nakamoto GOAT",
        nav_space: "Space GOAT",
        hero_collectible: "RGB21 collectible",
        total_supply: "TOTAL SUPPLY",
        uda: "UDA",
        mint_date_prefix: "Starts",
        summon_btn: "Summon {name}",
        stability: "Moonlight Stability",
        progress: "Summoning Progress",
        faq_title: "Frequently Asked Questions",
        feature_banner_title: "Bitcoin Season 3<br>GOAT",
        feature_banner_text: "The GOATs are arriving. Powered by Bitmask and DIBA, we are ushering in a new era of RGB Inscriptions.",
        feature_banner_subtext: "Join the revolution of client-side validated digital artifacts.",
        pill_label: "SUMMON:",
        standard: "Standard",
        classic: "Classic",
        nakamoto_name: "Nakamoto GOAT",
        space_name: "Space GOAT",
        goddess_name: "Goddess Test",
        pill_goddess: "Goddess",
        pill_nakamoto: "Nakamoto",
        pill_space: "Space",
        // Nakamoto Specific
        nakamoto_subtitle: "THE GENESIS BLUEPRINT ~ WHERE THE BITCOIN ODYSSEY BEGAN",
        nakamoto_desc: "A phantom of the silver night, Nakamoto GOAT silences the noise of the network to preserve order. Summon the moonlight's favor today.",
        nakamoto_mint_title: "Celestial Mint",
        // Space Specific
        space_subtitle: "THE FINAL FRONTIER ~ REACHING NEW HEIGHTS IN THE MINTVERSE",
        space_desc: "An ancient spirit of pure light, Space GOAT protects the Bitcoin network with sun-kissed grace. Establish your soul-bond and claim the stars.",
        space_mint_title: "Open mint",
        space_wl_title: "OG Whitelist üîí",
        // Goddess Specific
        goddess_subtitle: "The chicken or Egg",
        goddess_desc: "With a free public mint, 210 unique holders will be blessed with the Goddess GOAT of charity and world peace. Testing the RGB infrastructure and birthing Bitcoin Season 3.",
        goddess_mint_title: "Celestial Test Mint",
        free_mint: "FREE MINT",
        // FAQ items
        faq_q1: "Bitcoin Season 3 -- RGB",
        faq_a1: "The next evolution of Bitcoin, enabling smart contracts and scalable assets directly on the world's most secure network via the RGB protocol.",
        faq_q2: "USDT and GOAT",
        faq_a2: "GOAT collectibles live on the RGB protocol, which also supports Tether (USDT), allowing for seamless integration for minting and trading.",
        faq_q3: "RGB Inscriptions",
        faq_a3: "RGB Inscriptions are client-side validated smart contracts on Bitcoin, allowing for scalable and private digital assets.",
        faq_q4: "$Bet and GOAT",
        faq_a4: "$Bet introduces a new layer of utility for GOAT holders, enabling participation in decentralized prediction markets directly on the Bitcoin network via RGB.",
        faq_q5: "Secondary market - DIBA",
        faq_a5: "Discover and trade your GOATs on DIBA, the first marketplace for Bitcoin-native RGB assets.",
        faq_q6: "How to mint",
        faq_a6: "Connect your Bitmask wallet, select your guardian, and click 'Summon'. Ensure you have sufficient USDT/BTC on the RGB network.",
        faq_q7: "GOAT collection",
        faq_a7: "A limited series of digital guardians representing the strength and spirit of the Bitcoin ecosystem.",
        faq_q8: "The artist",
        faq_a8: "Crafted by visionary designers dedicated to modern Bitcoin aesthetics and \"Bitcoin Native\" culture.",
        faq_q9: "Bitcoin Native Finance",
        faq_a9: "Financial applications built directly on Bitcoin's base layer and Lightning Network, ensuring maximum security and privacy.",
        faq_q10: "Bitmask wallet",
        faq_a10: "Your portal to the RGB ecosystem. A secure browser extension for managing Bitcoin, Lightning, and RGB assets."
    },
    zh: {
        nav_goddess: "Â•≥Á•ûÊµãËØï",
        nav_nakamoto: "‰∏≠Êú¨ËÅ™ GOAT",
        nav_space: "Â§™Á©∫ GOAT",
        hero_collectible: "RGB21 Êî∂ËóèÂìÅ",
        total_supply: "ÊÄª‰æõÂ∫îÈáè",
        uda: "UDA",
        mint_date_prefix: "ÂºÄÂßãÊó∂Èó¥",
        summon_btn: "Âè¨Âî§ {name}",
        stability: "ÊúàÂÖâÁ®≥ÂÆöÊÄß",
        progress: "Âè¨Âî§ËøõÂ∫¶",
        faq_title: "Â∏∏ËßÅÈóÆÈ¢òËß£Á≠î",
        feature_banner_title: "ÊØîÁâπÂ∏ÅÁ¨¨‰∏âÂ≠£<br>GOAT",
        feature_banner_text: "GOAT Ê≠£Âú®Èôç‰∏¥„ÄÇÁî± Bitmask Âíå DIBA Âº∫ÂäõÈ©±Âä®ÔºåÊàë‰ª¨Ê≠£Âú®ÂºÄÂêØ RGB Èì≠ÊñáÁöÑÊñ∞Á∫™ÂÖÉ„ÄÇ",
        feature_banner_subtext: "Âä†ÂÖ•ÂÆ¢Êà∑Á´ØÈ™åËØÅÊï∞Â≠óËâ∫ÊúØÂìÅÁöÑÈù©ÂëΩ„ÄÇ",
        pill_label: "Âè¨Âî§:",
        standard: "Ê†áÂáÜÁâà",
        classic: "ÁªèÂÖ∏Áâà",
        nakamoto_name: "‰∏≠Êú¨ËÅ™ GOAT",
        space_name: "Â§™Á©∫ GOAT",
        goddess_name: "Â•≥Á•ûÊµãËØï",
        pill_goddess: "Â•≥Á•û",
        pill_nakamoto: "‰∏≠Êú¨ËÅ™",
        pill_space: "Â§™Á©∫",
        // Nakamoto Specific
        nakamoto_subtitle: "Âàõ‰∏ñËìùÂõæ ~ ÊØîÁâπÂ∏ÅÂ••Âæ∑ËµõÁöÑËµ∑Ê∫ê",
        nakamoto_desc: "‰∏≠Êú¨ËÅ™ GOAT ÊòØÈì∂Ëâ≤Â§úÊôöÁöÑÂπªÂΩ±ÔºåÂÆÉÂπ≥ÊÅØ‰∫ÜÁΩëÁªúÁöÑÂòàÊùÇ‰ª•Áª¥ÊåÅÁß©Â∫è„ÄÇ‰ªäÂ§©Â∞±Êù•ÂØªÊ±ÇÊúàÂÖâÁöÑÂûÇÈùíÂêß„ÄÇ",
        nakamoto_mint_title: "Â§©‰ΩìÈì∏ÈÄ†",
        // Space Specific
        space_subtitle: "ÊúÄÂêéÁöÑËæπÁïå ~ Âú®Èì∏ÈÄ†ÂÖÉÂÆáÂÆô‰∏≠ËææÂà∞Êñ∞È´òÂ∫¶",
        space_desc: "Â§™Á©∫ GOAT ÊòØÁ∫ØÂáÄÂÖâËäíÁöÑÂè§ËÄÅÁÅµÈ≠ÇÔºå‰ª•Èò≥ÂÖâËà¨ÁöÑ‰ºòÈõÖÂÆàÊä§ÁùÄÊØîÁâπÂ∏ÅÁΩëÁªú„ÄÇÂª∫Á´ã‰Ω†ÁöÑÁÅµÈ≠ÇÁ∫ΩÂ∏¶ÔºåÊëòÂèñÊòüËæ∞„ÄÇ",
        space_mint_title: "ÂÖ¨ÂºÄÈì∏ÈÄ†",
        space_wl_title: "OG ÁôΩÂêçÂçï üîí",
        // Goddess Specific
        goddess_subtitle: "ÂÖàÊúâÈ∏°ËøòÊòØÂÖàÊúâËõã",
        goddess_desc: "ÈÄöËøáÂÖçË¥πÁöÑÂÖ¨ÂºÄÈì∏ÈÄ†Ôºå210 ‰ΩçÁã¨ÁâπÁöÑÊåÅÊúâËÄÖÂ∞ÜËé∑ÂæóË±°ÂæÅÊÖàÂñÑ‰∏é‰∏ñÁïåÂíåÂπ≥ÁöÑÂ•≥Á•û GOAT ÁöÑÁ•ùÁ¶è„ÄÇÊµãËØï RGB Âü∫Á°ÄËÆæÊñΩÔºåÂ≠ïËÇ≤ÊØîÁâπÂ∏ÅÁ¨¨‰∏âÂ≠£„ÄÇ",
        goddess_mint_title: "Â§©‰ΩìÊµãËØïÈì∏ÈÄ†",
        free_mint: "ÂÖçË¥πÈì∏ÈÄ†",
        // FAQ items
        faq_q1: "ÊØîÁâπÂ∏ÅÁ¨¨‰∏âÂ≠£ -- RGB",
        faq_a1: "ÊØîÁâπÂ∏ÅÁöÑ‰∏ã‰∏ÄÊ¨°ËøõÂåñÔºåÈÄöËøá RGB ÂçèËÆÆÂú®‰∏ñÁïå‰∏äÊúÄÂÆâÂÖ®ÁöÑÁΩëÁªú‰∏äÁõ¥Êé•ÂÆûÁé∞Êô∫ËÉΩÂêàÁ∫¶ÂíåÂèØÊâ©Â±ïËµÑ‰∫ß„ÄÇ",
        faq_q2: "USDT ‰∏é GOAT",
        faq_a2: "GOAT Êî∂ËóèÂìÅËøêË°åÂú® RGB ÂçèËÆÆ‰∏äÔºåËØ•ÂçèËÆÆ‰πüÊîØÊåÅÊ≥∞ËææÂ∏Å (USDT)Ôºå‰ªéËÄåÂÆûÁé∞Èì∏ÈÄ†Âíå‰∫§ÊòìÁöÑÊó†ÁºùÈõÜÊàê„ÄÇ",
        faq_q3: "RGB Èì≠Êñá",
        faq_a3: "RGB Èì≠ÊñáÊòØÊØîÁâπÂ∏Å‰∏äÁªèËøáÂÆ¢Êà∑Á´ØÈ™åËØÅÁöÑÊô∫ËÉΩÂêàÁ∫¶ÔºåÊîØÊåÅÂèØÊâ©Â±ï‰∏îÁßÅÂØÜÁöÑÊï∞Â≠óËµÑ‰∫ß„ÄÇ",
        faq_q4: "$Bet ‰∏é GOAT",
        faq_a4: "$Bet ‰∏∫ GOAT ÊåÅÊúâËÄÖÂºïÂÖ•‰∫ÜÊñ∞ÁöÑÂÆûÁî®Â±ÇÔºåÊîØÊåÅÈÄöËøá RGB Áõ¥Êé•Âú®ÊØîÁâπÂ∏ÅÁΩëÁªú‰∏äÂèÇ‰∏éÂéª‰∏≠ÂøÉÂåñÈ¢ÑÊµãÂ∏ÇÂú∫„ÄÇ",
        faq_q5: "‰∫åÁ∫ßÂ∏ÇÂú∫ - DIBA",
        faq_a5: "Âú® DIBA ‰∏äÂèëÁé∞Âπ∂‰∫§ÊòìÊÇ®ÁöÑ GOATÔºåËøôÊòØÁ¨¨‰∏Ä‰∏™ÊØîÁâπÂ∏ÅÂéüÁîüÁöÑ RGB ËµÑ‰∫ßÂ∏ÇÂú∫„ÄÇ",
        faq_q6: "Â¶Ç‰ΩïÈì∏ÈÄ†",
        faq_a6: "ËøûÊé•ÊÇ®ÁöÑ Bitmask Èí±ÂåÖÔºåÈÄâÊã©ÊÇ®ÁöÑÂÆàÊä§ËÄÖÔºåÁÑ∂ÂêéÁÇπÂáª‚ÄúÂè¨Âî§‚Äù„ÄÇËØ∑Á°Æ‰øùÊÇ®ÁöÑ RGB ÁΩëÁªú‰∏äÊúâË∂≥Â§üÁöÑ USDT/BTC„ÄÇ",
        faq_q7: "GOAT Á≥ªÂàó",
        faq_a7: "‰∏ÄÁ≥ªÂàóÈôêÈáèÁöÑÊï∞Â≠óÂÆàÊä§ËÄÖÔºå‰ª£Ë°®‰∫ÜÊØîÁâπÂ∏ÅÁîüÊÄÅÁ≥ªÁªüÁöÑÂäõÈáèÂíåÁ≤æÁ•û„ÄÇ",
        faq_q8: "Ëâ∫ÊúØÂÆ∂",
        faq_a8: "Áî±Ëá¥Âäõ‰∫éÁé∞‰ª£ÊØîÁâπÂ∏ÅÁæéÂ≠¶Âíå‚ÄúÊØîÁâπÂ∏ÅÂéüÁîü‚ÄùÊñáÂåñÁöÑÂØåÊúâËøúËßÅÁöÑËÆæËÆ°Â∏àÁ≤æÂøÉÊâìÈÄ†„ÄÇ",
        faq_q9: "ÊØîÁâπÂ∏ÅÂéüÁîüÈáëËûç",
        faq_a9: "Áõ¥Êé•ÊûÑÂª∫Âú®ÊØîÁâπÂ∏ÅÂü∫Á°ÄÂ±ÇÂíåÈó™ÁîµÁΩëÁªú‰∏äÁöÑÈáëËûçÂ∫îÁî®ÔºåÁ°Æ‰øùÊúÄÈ´òÊ∞¥Âπ≥ÁöÑÂÆâÂÖ®ÊÄßÂíåÈöêÁßÅÊÄß„ÄÇ",
        faq_q10: "Bitmask Èí±ÂåÖ",
        faq_a10: "ÊÇ®ÈÄöÂæÄ RGB ÁîüÊÄÅÁ≥ªÁªüÁöÑÈó®Êà∑„ÄÇ‰∏Ä‰∏™Áî®‰∫éÁÆ°ÁêÜÊØîÁâπÂ∏Å„ÄÅÈó™ÁîµÁΩëÁªúÂíå RGB ËµÑ‰∫ßÁöÑÂÆâÂÖ®ÊµèËßàÂô®Êâ©Â±ï„ÄÇ"
    }
};

class LanguageManager {
    constructor() {
        this.currentLang = localStorage.getItem('btc_season3_lang') ||
            (navigator.language.startsWith('zh') ? 'zh' : 'en');
        this.init();
    }

    init() {
        this.updateButtons();
        this.translatePage();
        this.applyLanguageToBody();
    }

    setLanguage(lang) {
        this.currentLang = lang;
        localStorage.setItem('btc_season3_lang', lang);
        this.init();
    }

    applyLanguageToBody() {
        document.documentElement.lang = this.currentLang;
    }

    updateButtons() {
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.classList.toggle('active', btn.dataset.lang === this.currentLang);
            btn.addEventListener('click', () => this.setLanguage(btn.dataset.lang), { once: true });
        });
    }

    translatePage() {
        const elements = document.querySelectorAll('[data-i18n]');
        elements.forEach(el => {
            const key = el.getAttribute('data-i18n');
            let translation = translations[this.currentLang][key] || translations['en'][key];

            if (translation) {
                // Handle interpolation
                const vars = el.getAttribute('data-i18n-vars');
                if (vars) {
                    const parsedVars = JSON.parse(vars);
                    Object.keys(parsedVars).forEach(v => {
                        translation = translation.replace(`{${v}}`, parsedVars[v]);
                    });
                }

                // Keep inner HTML structure if it contains tags like <b> or <br>
                if (translation.includes('<')) {
                    el.innerHTML = translation;
                } else {
                    el.textContent = translation;
                }
            }
        });
    }
}

document.addEventListener('DOMContentLoaded', () => {
    const langManager = new LanguageManager();

    // ... (keep the rest of the existing logic) ...
    // Progress bar animation simulation
    const progressBar = document.querySelector('.progress-bar');
    const progressPercent = document.querySelector('.progress-percent');

    if (progressBar && progressPercent) {
        // Simulate initial progress after load
        setTimeout(() => {
            const targetProgress = parseInt(progressPercent.getAttribute('data-percent')) || 0;
            const targetCount = parseInt(progressPercent.getAttribute('data-count')) || 0;
            const total = parseInt(progressPercent.getAttribute('data-total')) || 0;

            const formatNumber = (num) => num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

            progressBar.style.width = `${targetProgress}%`;
            progressBar.style.background = '#fbbf24'; // Gold fill for the 70%
            progressPercent.textContent = `${targetProgress}% (${formatNumber(targetCount)}/${formatNumber(total)})`;
        }, 800);
    }

    // Atomic Mint button clicks
    const mintButtons = document.querySelectorAll('.mint-btn:not(.disabled), .floating-mint-cta');

    const showSuccessModal = () => {
        const modal = document.getElementById('success-modal');
        if (!modal) return;

        // Populate Twitter link
        const shareLink = document.getElementById('share-x-link');
        if (shareLink) {
            const currentGoat = document.body.classList.contains('mode-nakamoto-goat') ? 'Nakamoto GOAT' :
                document.body.classList.contains('mode-space-goat') ? 'Space GOAT' : 'Goddess GOAT';
            const text = encodeURIComponent(`I just summoned my ${currentGoat} on Bitcoin Season 3! üöÄ\n\nThe GOATs are arriving via RGB Inscriptions. \n\n#BitcoinSeason3 #RGB #GOAT #BitcoinNative @DIBA_utxo`);
            const url = encodeURIComponent(window.location.href);
            shareLink.href = `https://twitter.com/intent/tweet?text=${text}&url=${url}`;
        }

        modal.classList.add('active');

        // Create Confetti
        const modalContent = modal.querySelector('.modal-content');
        for (let i = 0; i < 30; i++) {
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            confetti.style.left = Math.random() * 100 + '%';
            confetti.style.backgroundColor = ['#fbbf24', '#fcd34d', '#ffffff'][Math.floor(Math.random() * 3)];
            confetti.style.animationDelay = Math.random() * 2 + 's';
            confetti.style.width = Math.random() * 8 + 4 + 'px';
            confetti.style.height = confetti.style.width;
            modalContent.appendChild(confetti);
            setTimeout(() => confetti.remove(), 3000);
        }
    };

    mintButtons.forEach(btn => {
        btn.addEventListener('click', (e) => {
            // If it's the floating CTA, it normally scrolls to top. Let's make it summon if it's "active" or just summon anyway for fun.
            const originalText = btn.textContent;
            btn.textContent = 'Summoning...';
            btn.disabled = true;

            // Mock processing
            setTimeout(() => {
                btn.textContent = originalText;
                btn.disabled = false;
                showSuccessModal();
            }, 1500);
        });
    });

    const closeBtn = document.getElementById('close-modal-btn');
    if (closeBtn) {
        closeBtn.addEventListener('click', () => {
            document.getElementById('success-modal').classList.remove('active');
        });
    }

    // Hover effect for image cards - parallax-ish
    const cards = document.querySelectorAll('.image-card');
    cards.forEach(card => {
        card.addEventListener('mousemove', (e) => {
            const rect = card.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            const centerX = rect.width / 2;
            const centerY = rect.height / 2;

            const rotateX = (y - centerY) / 20;
            const rotateY = (centerX - x) / 20;

            card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
        });

        card.addEventListener('mouseleave', () => {
            card.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg)';
        });
    });

    // Countdown Timer Logic
    const startCountdown = (elementId, targetDateStr) => {
        const element = document.getElementById(elementId);
        if (!element) return;

        const targetDate = new Date(targetDateStr).getTime();

        const updateTimer = () => {
            const now = new Date().getTime();
            const distance = targetDate - now;

            if (distance < 0) {
                element.textContent = "LIVE NOW";
                element.classList.add('live');
                return;
            }

            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            element.textContent = `${days}d ${hours}h ${minutes}m ${seconds}s`;
        };

        updateTimer();
        setInterval(updateTimer, 1000);
    };

    startCountdown('space-goat-timer', 'January 12, 2026 00:00:00');
    startCountdown('space-goat-timer-classic', 'January 12, 2026 00:00:00');
    startCountdown('space-goat-wl-timer', 'January 12, 2026 00:00:00');
    startCountdown('space-goat-wl-timer-classic', 'January 12, 2026 00:00:00');
    startCountdown('nakamoto-timer', 'January 12, 2026 00:00:00');
    startCountdown('nakamoto-timer-classic', 'January 12, 2026 00:00:00');
    startCountdown('goddess-timer', 'January 12, 2026 00:00:00');
    startCountdown('goddess-timer-classic', 'January 12, 2026 00:00:00');

    // FAQ Accordion
    const faqItems = document.querySelectorAll('.faq-item');
    faqItems.forEach(item => {
        const question = item.querySelector('.faq-question');
        question.addEventListener('click', () => {
            const isActive = item.classList.contains('active');

            // Close all other items
            faqItems.forEach(otherItem => {
                otherItem.classList.remove('active');
            });

            // Toggle current item
            if (!isActive) {
                item.classList.add('active');
            }
        });
    });
    // Floating CTA scroll logic
    const floatingCta = document.querySelector('.floating-mint-cta');
    const mintSection = document.querySelector('.mint-section');

    if (floatingCta && mintSection) {
        window.addEventListener('scroll', () => {
            const mintRect = mintSection.getBoundingClientRect();
            // Show button after user scrolls past the middle of the mint section
            if (mintRect.bottom < (window.innerHeight / 2)) {
                floatingCta.classList.add('active');
            } else {
                floatingCta.classList.remove('active');
            }
        });

        floatingCta.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
    }

    // Scroll Reveal Logic
    const revealCallback = (entries, observer) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('active');
                // Optional: stop observing once revealed
                // observer.unobserve(entry.target);
            }
        });
    };

    const revealObserver = new IntersectionObserver(revealCallback, {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    });

    document.querySelectorAll('.reveal').forEach(el => {
        revealObserver.observe(el);
    });
});
